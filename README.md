# alignment_of_license_plates
Алгоритм:

![alt text](results/blok1.jpg)

- **Описание блока предобработка изображения**;  
На данном этапе важно получить четкие бинаризированные границы номера для дальнейшеших преобразований.  
С этой целью на этапе предобаботки были применены следующие алгоритмы:  
1) Гамма коррекция изображения с целью подчеркнуть черно-белую составляющую изображения(сам номер);  
![alt text](results/gamma.jpg)  
2) Избавляемся от цветовых каналов, переводим изображение в черно-белое;  
![alt text](results/gray.jpg)  
3) Применяем Оператор Собеля к изображению, где вычисляем градиент яркости с целью подчеркнуть границы на изображении;  
![alt text](results/sobel.jpg)  
4) Удалим излишек шумов через ядро Гаусса;  
![alt text](results/blur.jpg)  
5) Бинаризируем изображение через трешхолд+порог Оцу и наращиваем границы;  
![alt text](results/thresh.jpg)  
6) Оставим только края границ.(Данный алгоритм включает пункт 3, 5)  
![alt text](results/edges.jpg)  
**Поиск границ номера**  
![alt text](results/blok2.jpg)  
- **Описание блока "Поиск линий преобразованием Хафа".**  
Данный алгоритм я не реализовывал, хорошее описание есть тут: https://docs.opencv.org/3.4/d9/db0/tutorial_hough_lines.html  
- **Описание блока "Поиск лучших линий":**  
![alt text](results/blok3.jpg)  
- **Описание блока "Поиск оптимальных линий по центральной точке".**  
Описание проблемы: Преобразование Хафа ищет линии по 3м параметрам: радиус, угол, количество пересечений. Если на заданном радиусе и угле есть определенное количество пересечений, то алгоритм считает, что в этом месте лежит линия. Проблема заключается в том, что не для всех границ данные параметры одинаковы, и в таком случае можно не получить важные линии, в итоге не получив границ номера для выравнивания.  
Пример показан ниже:  
![alt text](results/image2.jpg)  
Можно наблюдать, что для верхней границы нужно больше пересечений, чтобы алгоритм Преобразования Хафа нашел эту линию.
Алгоритм решения задачи:  
1) Зададим координаты точки, которая будет являться центром изображения;  
![alt text](results/point.jpg)  
2) Проведем через неё горизонтальную и вертикальные линии, таким образом получим 4 области на плоскости изображения;  
![alt text](results/cross.jpg)  
3) Если хотя бы 2 линии будут лежать во всех 4х областях, тогда такое количество линий в результате преобразования Хафа можно считать оптимальным, то есть:  
Если условие не выполнено, уменьшаеем количество пересечений для преобразования Хафа;  
Если условие выполнено, алгоритм заканчивается;  
В результате получаем следующую картину:  
![alt text](results/image3.jpg)  
- **Описание блока выравнивание:**  
Получаем номер с выравненной геометрией  
![alt text](results/warped.jpg) 

 



